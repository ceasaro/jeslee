{% extends 'bookkeeping/transactions/transaction-base.html' %}

{% block page-content %}

    <div class="financial-info">
        <dl class="financial-summary">
            <dt>total betaald in {{ request.financial_year }}</dt>
                <dd>€ {{ payments.sum_amount|floatformat:"2" }}</dd>
            <dt>belasting betaald in {{ request.financial_year }}</dt>
                <dd>€ {{ payments.sum_tax|floatformat:"2" }}</dd>
        </dl>
    </div>

    <h2>Overzicht betalingen</h2>

    <div class="payment-filter">
        <form action="" method="get">
            <select name="category">
                    <option value="-1">Kies een categorie</option>
                {% for category in categories %}
                    <option value="{{ category.id }}"
                            {% if category == selected_category %}selected="selected"{% endif %}>{{ category.name }}</option>
                {% endfor %}
            </select>
            <select name="client">
                    <option value="-1">Kies een klant</option>
                {% for client in clients %}
                    <option value="{{ client.id }}"
                            {% if client == selected_client %}selected="selected"{% endif %}>{{ client.name }}</option>
                {% endfor %}
            </select>
            <button type="submit">Filter bonnetjes</button>
        </form>
    </div>

    <div class="payment-list-container">
        <table class="payment-list" >
            <thead>
                <tr>
                    <th>&nbsp;</th>
                    <th>
                        <a href="?year={{ request.financial_year }}&ob={% if payments.ordered_by == 'pay_date' %}-{% endif %}pay_date">datum</a>
                    </th>
                    <th>
                        <a href="?year={{ request.financial_year }}&ob={% if payments.ordered_by == 'client' %}-{% endif %}client">klant</a>
                    </th>
                    <th>
                        <a href="?year={{ request.financial_year }}&ob={% if payments.ordered_by == 'category' %}-{% endif %}category">categorie</a>
                    </th>
                    <th>
                        bedrag
                    </th>
                    <th>
                        belasting
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for payment in payments.list %}
                    <tr>
                        <td>
                            <a href="{% url 'update_payment' payment.id %}"><img src="{{ STATIC_URL }}icons/pencil.png"/></a>
                        </td>
                        <td>{{ payment.pay_date }}</td>
                        <td>{{ payment.client }}</td>
                        <td>{{ payment.category }}</td>
                        <td>€ {{ payment.amount|floatformat:"2" }}</td>
                        <td>€ {{ payment.tax|floatformat:"2" }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div>
        {% with paginator=payments.list %}
            {% include 'bookkeeping/includes/snippet-pagination.html' %}
        {% endwith %}
    </div>
{% endblock %}
